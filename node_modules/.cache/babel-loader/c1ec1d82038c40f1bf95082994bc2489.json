{"ast":null,"code":"import _toConsumableArray from\"/Users/pguasco/Projects/challenge-cabify/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _classCallCheck from\"/Users/pguasco/Projects/challenge-cabify/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"/Users/pguasco/Projects/challenge-cabify/node_modules/@babel/runtime/helpers/esm/createClass.js\";var checkout=/*#__PURE__*/function(){function checkout(articles,items){_classCallCheck(this,checkout);this.foundArticle=false;this.items=[];this.articles={};this.articles=articles;this.items=items;}_createClass(checkout,[{key:\"scan\",value:function scan(code){var repeatedItem=this.items.find(function(item){return item.code===code;});if(repeatedItem){repeatedItem.quantity=repeatedItem.quantity+1;repeatedItem.price=repeatedItem.price+this.articles[code].price;var newArr=_toConsumableArray(this.items);newArr[this.items.indexOf(repeatedItem)]=repeatedItem;this.items=_toConsumableArray(newArr);this.foundArticle=true;}else if(this.articles[code]){var newItem={code:code,name:this.articles[code].name,quantity:1,price:this.articles[code].price};this.items=[].concat(_toConsumableArray(this.items),[newItem]);this.foundArticle=true;}return this;}},{key:\"total\",value:function total(){var sum=0;//TODO: import this logic from pricing-rules file\nfor(var i=0;i<this.items.length;i+=1){// Buy two of them, get one free. (e.g: pay 10€ for 4 mugs)\nif(this.items[i].code==='MUG'&&this.items[i].quantity>1){sum+=~~(this.items[i].quantity/2)*this.articles[this.items[i].code].price;if(this.items[i].quantity%2===1){sum+=this.articles[this.items[i].code].price;}}// Buying 3 or more of this product, the price per unit is reduced by 5%\nelse if(this.items[i].code==='TSHIRT'&&this.items[i].quantity>2){sum+=this.items[i].quantity*this.articles[this.items[i].code].price-this.items[i].quantity*this.articles[items[i].code].price*0.05;}else{sum+=this.items[i].quantity*this.articles[this.items[i].code].price;}}return sum;}}]);return checkout;}();export default checkout;","map":{"version":3,"names":["checkout","articles","items","foundArticle","code","repeatedItem","find","item","quantity","price","newArr","indexOf","newItem","name","sum","i","length"],"sources":["/Users/pguasco/Projects/challenge-cabify/src/entities/checkout.ts"],"sourcesContent":["import type Checkout from './ICheckout';\n\ntype Item  = {\n    code: string,\n    name: string,\n    quantity: number,\n    price: number,\n}\n\nclass checkout implements Checkout {\n    foundArticle: boolean = false;\n    items: Item[] = [];\n    articles: Object = {};\n\n    constructor (articles: Object, items: Item[]) {\n        this.articles = articles;\n        this.items = items;\n    }\n\n    scan(code: string): this {\n        const repeatedItem = this.items.find(item => item.code === code)\n        if (repeatedItem) {\n            repeatedItem.quantity = repeatedItem.quantity + 1;\n            repeatedItem.price = repeatedItem.price + this.articles[code].price;\n            let newArr = [...this.items];\n            newArr[this.items.indexOf(repeatedItem)] = repeatedItem;\n            this.items = [...newArr];\n            this.foundArticle = true;\n        } else if (this.articles[code]) {\n            const newItem: Item = {\n                code,\n                name: this.articles[code].name,\n                quantity: 1,\n                price: this.articles[code].price,\n            }\n            this.items = [...this.items, newItem];\n            this.foundArticle = true;\n        }\n        return this;\n    }\n\n    total(): number {\n        let sum = 0;\n        //TODO: import this logic from pricing-rules file\n        for (let i = 0; i < this.items.length; i += 1) {\n            // Buy two of them, get one free. (e.g: pay 10€ for 4 mugs)\n            if (this.items[i].code === 'MUG' && this.items[i].quantity > 1) {\n                sum += ~~(this.items[i].quantity / 2) * this.articles[this.items[i].code].price;\n                if ((this.items[i].quantity % 2) === 1) {\n                    sum += this.articles[this.items[i].code].price;\n                }\n            } // Buying 3 or more of this product, the price per unit is reduced by 5%\n            else if (this.items[i].code === 'TSHIRT' && this.items[i].quantity > 2) {\n                sum += (this.items[i].quantity * this.articles[this.items[i].code].price) - ((this.items[i].quantity * this.articles[items[i].code].price) * 0.05);\n            } else {\n                sum += this.items[i].quantity * this.articles[this.items[i].code].price;\n            }\n        }\n        return sum;\n    }\n}\n\nexport default checkout;"],"mappings":"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"},"metadata":{},"sourceType":"module"}