{"ast":null,"code":"class CheckoutCabify {\n  constructor(items, articles, setItems) {\n    this.foundArticle = false;\n    this.items = [];\n    this.articles = {};\n\n    this.setItems = () => {};\n\n    this.items = items;\n    this.articles = articles;\n    this.setItems = setItems;\n  }\n\n  scan(code) {\n    const repeatedItem = this.items.find(item => item.code === code);\n\n    if (repeatedItem) {\n      repeatedItem.quantity = repeatedItem.quantity + 1;\n      repeatedItem.price = repeatedItem.price + this.articles[code].price;\n      let newArr = [...this.items];\n      newArr[this.items.indexOf(repeatedItem)] = repeatedItem;\n      this.setItems(newArr);\n      this.foundArticle = true;\n    } else if (this.articles[code]) {\n      const newItem = {\n        code,\n        name: this.articles[code].name,\n        quantity: 1,\n        price: this.articles[code].price\n      };\n      this.setItems([...this.items, newItem]);\n      this.foundArticle = true;\n    }\n\n    return this;\n  }\n\n  total() {\n    let sum = 0;\n\n    for (let i = 0; i < this.items.length; i += 1) {\n      if (this.items[i].code === 'MUG' && this.items[i].quantity > 1) {\n        sum += ~~(this.items[i].quantity / 2) * this.articles[this.items[i].code].price;\n\n        if (this.items[i].quantity % 2 === 1) {\n          sum += this.articles[this.items[i].code].price;\n        }\n      } else if (this.items[i].code === 'TSHIRT' && this.items[i].quantity > 2) {\n        sum += this.items[i].quantity * this.articles[this.items[i].code].price - this.items[i].quantity * articles[items[i].code].price * 0.05;\n      } else {\n        sum += this.items[i].quantity * this.articles[this.items[i].code].price;\n      }\n    }\n\n    return sum;\n  }\n\n}\n\nexport default CheckoutCabify;","map":{"version":3,"names":["CheckoutCabify","constructor","items","articles","setItems","foundArticle","scan","code","repeatedItem","find","item","quantity","price","newArr","indexOf","newItem","name","total","sum","i","length"],"sources":["/Users/pguasco/Projects/challenge-cabify/src/Classes/checkout-cabify.tsx"],"sourcesContent":["type Item  = {\n    code: string,\n    name: string,\n    quantity: number,\n    price: number,\n}\n\ninterface Checkout {\n    foundArticle: boolean;\n    /**\n     * Scans a product adding it to the current cart.\n     * @param code The product identifier\n     * @returns itself to allow function chaining\n     */\n    scan(code: string): this;\n    /**\n     * Returns the value of all cart products with the discounts applied.\n     */\n    total(): number;\n}\n\n\nclass CheckoutCabify implements Checkout {\n    foundArticle: boolean = false;\n    items: Item[] = [];\n    articles: Object = {};\n    setItems: Function = () => {};\n\n    constructor (items:Item[], articles: Object, setItems: Function) {\n        this.items = items;\n        this.articles = articles;\n        this.setItems = setItems;\n    }\n\n    scan(code: string): this {\n        const repeatedItem = this.items.find(item => item.code === code)\n        if (repeatedItem) {\n            repeatedItem.quantity = repeatedItem.quantity + 1;\n            repeatedItem.price = repeatedItem.price + this.articles[code].price;\n            let newArr = [...this.items];\n            newArr[this.items.indexOf(repeatedItem)] = repeatedItem;\n            this.setItems(newArr);\n            this.foundArticle = true;\n        } else if (this.articles[code]) {\n            const newItem: Item = {\n                code,\n                name: this.articles[code].name,\n                quantity: 1,\n                price: this.articles[code].price,\n            }\n            this.setItems([...this.items, newItem]);\n            this.foundArticle = true;\n        }\n        return this;\n    }\n    total(): number {\n        let sum = 0;\n        for (let i = 0; i < this.items.length; i += 1) {\n            if (this.items[i].code === 'MUG' && this.items[i].quantity > 1) {\n                sum += ~~(this.items[i].quantity / 2) * this.articles[this.items[i].code].price;\n                if ((this.items[i].quantity % 2) === 1) {\n                    sum += this.articles[this.items[i].code].price;\n                }\n            } else if (this.items[i].code === 'TSHIRT' && this.items[i].quantity > 2) {\n                sum += (this.items[i].quantity * this.articles[this.items[i].code].price) - ((this.items[i].quantity * articles[items[i].code].price) * 0.05);\n            } else {\n                sum += this.items[i].quantity * this.articles[this.items[i].code].price;\n            }\n        }\n        return sum;\n    }\n}\n\nexport default CheckoutCabify;"],"mappings":"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"},"metadata":{},"sourceType":"module"}