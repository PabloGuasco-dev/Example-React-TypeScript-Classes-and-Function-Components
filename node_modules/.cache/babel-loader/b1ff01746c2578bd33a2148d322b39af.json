{"ast":null,"code":"var _jsxFileName = \"/Users/pguasco/Projects/challenge-cabify/src/Components/checkout.tsx\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState } from 'react';\nimport { useGetData } from '../Hooks/useApiCall';\nimport Modal from './modal';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nconst CheckoutView = () => {\n  _s();\n\n  const [items, setItems] = useState([]);\n  const [total, setTotal] = useState(0);\n  const [show, setShow] = useState(false);\n  const [selectedItem, setSelectedItem] = useState();\n  let articles = {}; //implementing extended interface\n\n  class CheckoutCabify {\n    constructor() {\n      this.foundArticle = false;\n    }\n\n    scan(code) {\n      const repeatedItem = items.find(item => item.code === code);\n\n      if (repeatedItem) {\n        repeatedItem.quantity = repeatedItem.quantity + 1;\n        repeatedItem.price = repeatedItem.price + articles[code].price;\n        let newArr = [...items];\n        newArr[items.indexOf(repeatedItem)] = repeatedItem;\n        setItems(newArr);\n        this.foundArticle = true;\n      } else if (articles[code]) {\n        const newItem = {\n          code,\n          name: articles[code].name,\n          quantity: 1,\n          price: articles[code].price\n        };\n        setItems([...items, newItem]);\n        this.foundArticle = true;\n      }\n\n      return this;\n    }\n\n    total() {\n      let sum = 0;\n\n      for (let i = 0; i < items.length; i += 1) {\n        if (items[i].code === 'MUG' && items[i].quantity > 1) {\n          sum += ~~(items[i].quantity / 2) * articles[items[i].code].price;\n\n          if (items[i].quantity % 2 === 1) {\n            sum += articles[items[i].code].price;\n          }\n        } else if (items[i].code === 'TSHIRT' && items[i].quantity > 2) {\n          sum += items[i].quantity * articles[items[i].code].price - items[i].quantity * articles[items[i].code].price * 0.05;\n        } else {\n          sum += items[i].quantity * articles[items[i].code].price;\n        }\n      }\n\n      return sum;\n    }\n\n  }\n\n  const checkoutCabify = new CheckoutCabify();\n  articles = useGetData().data;\n  useEffect(() => {\n    setTotal(checkoutCabify.total); // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [items]);\n\n  const addItem = event => {\n    if (event.target.value !== \"\") {\n      const foundArticle = checkoutCabify.scan(event.target.value).foundArticle;\n\n      if (foundArticle) {\n        setTimeout(() => {\n          event.target.value = \"\";\n        }, 200);\n      }\n    }\n  };\n\n  const reset = () => {\n    setItems([]);\n    setTotal(0);\n  };\n\n  const handleClose = () => {\n    setShow(false);\n  };\n\n  const handleShow = item => {\n    setSelectedItem(item);\n    setShow(true);\n  };\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"form-group\",\n      children: [/*#__PURE__*/_jsxDEV(\"label\", {\n        children: \"Insert Code:\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 111,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        onChange: event => addItem(event),\n        type: \"text\",\n        className: \"form-control\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 112,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"container-table\",\n        children: [/*#__PURE__*/_jsxDEV(\"table\", {\n          className: \"table\",\n          children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n            children: /*#__PURE__*/_jsxDEV(\"tr\", {\n              className: \"listItem\",\n              children: [/*#__PURE__*/_jsxDEV(\"th\", {\n                children: \"Code\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 117,\n                columnNumber: 29\n              }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                children: \"Description\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 118,\n                columnNumber: 29\n              }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                children: \"Quantity\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 119,\n                columnNumber: 29\n              }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                children: \"Price\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 120,\n                columnNumber: 29\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 116,\n              columnNumber: 25\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 115,\n            columnNumber: 21\n          }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n            children: items && items.map(item => /*#__PURE__*/_jsxDEV(\"tr\", {\n              className: \"listItem\",\n              onClick: () => handleShow(item),\n              children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                children: item.code\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 125,\n                columnNumber: 29\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                children: item.name\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 126,\n                columnNumber: 29\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                children: item.quantity\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 127,\n                columnNumber: 29\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                children: item.price\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 128,\n                columnNumber: 29\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                children: \"...\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 129,\n                columnNumber: 29\n              }, this)]\n            }, item.code, true, {\n              fileName: _jsxFileName,\n              lineNumber: 124,\n              columnNumber: 55\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 123,\n            columnNumber: 21\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 114,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n          children: [\"Total: \", total]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 133,\n          columnNumber: 17\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 113,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        type: \"button\",\n        className: \"btn btn-primary\",\n        onClick: reset,\n        children: \"Reset\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 135,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 110,\n      columnNumber: 11\n    }, this), show && /*#__PURE__*/_jsxDEV(Modal, {\n      handleClose: handleClose,\n      selectedItem: selectedItem\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 136,\n      columnNumber: 25\n    }, this)]\n  }, void 0, true);\n};\n\n_s(CheckoutView, \"GHraPGEJcKrdgJAb/ZKfllwDWQ8=\", false, function () {\n  return [useGetData];\n});\n\n_c = CheckoutView;\nexport default CheckoutView;\n\nvar _c;\n\n$RefreshReg$(_c, \"CheckoutView\");","map":{"version":3,"names":["React","useEffect","useState","useGetData","Modal","CheckoutView","items","setItems","total","setTotal","show","setShow","selectedItem","setSelectedItem","articles","CheckoutCabify","foundArticle","scan","code","repeatedItem","find","item","quantity","price","newArr","indexOf","newItem","name","sum","i","length","checkoutCabify","data","addItem","event","target","value","setTimeout","reset","handleClose","handleShow","map"],"sources":["/Users/pguasco/Projects/challenge-cabify/src/Components/checkout.tsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { useGetData } from '../Hooks/useApiCall';\nimport Modal from './modal';\n\ninterface Item {\n    code: string,\n    name: string,\n    quantity: number,\n    price: number,\n}\n\ninterface Checkout {\n    foundArticle: boolean;\n    /**\n     * Scans a product adding it to the current cart.\n     * @param code The product identifier\n     * @returns itself to allow function chaining\n     */\n    scan(code: string): this;\n    /**\n     * Returns the value of all cart products with the discounts applied.\n     */\n    total(): number;\n}\n\nconst CheckoutView = () => {\n    const [items, setItems] = useState<Item[]>([]);\n    const [total, setTotal] = useState<number>(0);\n    const [show, setShow] = useState(false);\n    const [selectedItem, setSelectedItem] = useState()\n\n    let articles: any = {};\n\n    //implementing extended interface\n    class CheckoutCabify implements Checkout {\n        foundArticle = false;\n\n        scan(code: string): this {\n            const repeatedItem = items.find(item => item.code === code)\n            if (repeatedItem) {\n                repeatedItem.quantity = repeatedItem.quantity + 1;\n                repeatedItem.price = repeatedItem.price + articles[code].price;\n                let newArr = [...items];\n                newArr[items.indexOf(repeatedItem)] = repeatedItem;\n                setItems(newArr);\n                this.foundArticle = true;\n            } else if (articles[code]) {\n                const newItem: Item = {\n                    code,\n                    name: articles[code].name,\n                    quantity: 1,\n                    price: articles[code].price,\n                }\n                setItems([...items, newItem]);\n                this.foundArticle = true;\n            }\n            return this;\n        }\n        total(): number {\n            let sum = 0;\n            for (let i = 0; i < items.length; i += 1) {\n                if (items[i].code === 'MUG' && items[i].quantity > 1) {\n                    sum += ~~(items[i].quantity / 2) * articles[items[i].code].price;\n                    if ((items[i].quantity % 2) === 1) {\n                        sum += articles[items[i].code].price;\n                    }\n                } else if (items[i].code === 'TSHIRT' && items[i].quantity > 2) {\n                    sum += (items[i].quantity * articles[items[i].code].price) - ((items[i].quantity * articles[items[i].code].price) * 0.05);\n                } else {\n                    sum += items[i].quantity * articles[items[i].code].price;\n                }\n            }\n            return sum;\n        }\n    }\n\n    const checkoutCabify = new CheckoutCabify();\n\n    articles = useGetData().data;\n\n    useEffect(() => {\n        setTotal(checkoutCabify.total);\n        // eslint-disable-next-line react-hooks/exhaustive-deps\n    }, [items]);\n\n    const addItem = (event) => {\n        if (event.target.value !== \"\") {\n            const foundArticle = checkoutCabify.scan(event.target.value).foundArticle;\n            if (foundArticle) {\n                setTimeout(() => {\n                    event.target.value = \"\";\n                }, 200)\n\n            }\n        }\n    }\n\n    const reset = () => {\n        setItems([]);\n        setTotal(0);\n    }\n\n    const handleClose = () => {setShow(false)};\n    const handleShow = (item) => {\n        setSelectedItem(item);\n        setShow(true);        \n    }\n\n    return (\n        <><div className=\"form-group\">\n            <label>Insert Code:</label>\n            <input onChange={(event) => addItem(event)} type=\"text\" className=\"form-control\"></input>\n            <div className=\"container-table\">\n                <table className=\"table\">\n                    <thead>\n                        <tr className='listItem'>\n                            <th>Code</th>\n                            <th>Description</th>\n                            <th>Quantity</th>\n                            <th>Price</th>\n                        </tr>\n                    </thead>\n                    <tbody>\n                        {items && items.map((item) => <tr className='listItem' onClick={() => handleShow(item)} key={item.code}>\n                            <td>{item.code}</td>\n                            <td>{item.name}</td>\n                            <td>{item.quantity}</td>\n                            <td>{item.price}</td>\n                            <td>...</td>\n                        </tr>)}\n                    </tbody>\n                </table>\n                <label>Total: {total}</label>\n            </div>\n            <button type=\"button\" className=\"btn btn-primary\" onClick={reset}>Reset</button>\n        </div>{ show && <Modal handleClose={ handleClose } selectedItem={ selectedItem }>\n                        </Modal>}</>\n    )\n}\n\nexport default CheckoutView;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}